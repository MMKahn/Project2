---
title: "ST 558 Project 2"
author: "Melanie Kahn & Bennett McAuley"
date: "2022-10-02"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(httr)
library(jsonlite)
library(tidyverse)
```

# Overview

The purpose and overall goal of this vignette is to instruct the user on how to contact an API using functions we created to query, parse, and return data in a well-structured format. These functions drive a basic exploratory analysis.

This vignette makes use of the beer data API by the [Open Brewery DB](https://www.openbrewerydb.org/faq) project.

## Requirements {.tabset}

The following packages are required to run the code properly:

- `httr`
- `jsonlite`
- `tidyverse`

### The Data 

```{r}
library(httr)
breweries <- GET("https://api.openbrewerydb.org/breweries")
str(breweries, max.level = 1)
```

### Function Definitions

This section is dedicated to showcasing all of the functions go into contacting the API, querying data, and performing our basic exploratory analysis.

#### Get_OB_DataFrame

```{r API contact}
Get_OB_DataFrame <- function(search_by, input) {
  if (search_by %in% c("city", "state", "country", "type", "name")) {
    query <- GET(paste0("https://api.openbrewerydb.org/breweries?by_", search_by, "=", input))
  } else stop("Invalid search category. Please use one of these options: 'city', 'state', 'country', 'type' or 'name'.")
  
  query_parse <- fromJSON(rawToChar(query$content))
  
  df <- as.data.frame(query_parse)
  
  return(df)
}
```

